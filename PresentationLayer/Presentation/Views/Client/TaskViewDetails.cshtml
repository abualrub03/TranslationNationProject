@model ViewModel.CurrentTasksListViewModel
@{
    ViewData["Title"] = "TaskViewDetails";
    Layout = "~/Views/Shared/ClientLayout.cshtml";

}


<!-- banner section start start-->
<div class="index1-listing-slider-wrapper float_left" style="margin-top: -15vh;">
    <div class="container">
        <div class="slider-text text-center">
            <h4 style="margin-top: 15vh;">@Model.currentTasksViewModels.FirstOrDefault().TaskServiceCategoryId</h4>
            <ul>

                <li>@Model.currentTasksViewModels.FirstOrDefault().TaskServiceId</li>
            </ul>
        </div>
    </div>
</div>
<!-- banner section start end-->
<!-- inner page -->

<div class="inner-page-main-wrapper float_left">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-12">
                <div class="develop_main_wrapper">
                    <div class="develop-cont" style="width: -webkit-fill-available;">
                        <a href="javascript:;">
                            <h3 style="
    margin: 0 auto;
    text-align: center;
">
                                <input id="title" value="@Model.currentTasksViewModels.FirstOrDefault().TaskTitle" readonly type="text" placeholder="Title" style="padding: 10px 15px; margin: 1vh; border-radius: 8px; border: 1px solid #ddd; font-size: 16px; background-color: #fefefe; color: #333; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); transition: border-color 0.3s, box-shadow 0.3s; width: calc(100% - 32px); max-width: 400px;" onfocus="this.style.borderColor='#007BFF'; this.style.boxShadow='0 2px 8px rgba(0, 123, 255, 0.25)';" onblur="this.style.borderColor='#ddd'; this.style.boxShadow='0 2px 4px rgba(0, 0, 0, 0.1)';">
                                <small>
                                    Categorie: @Model.currentTasksViewModels.FirstOrDefault().TaskServiceCategoryId &nbsp; <i class="fas fa-check-square"></i>
                                </small>
                            </h3>
                        </a>
                        <ul style="margin: 0 auto; place-content: center;">
                            <li>
                                <span><i class="fas fa-dollar-sign"></i></span>Free
                            </li>

                            <li>
                                <span><i class="far fa-clock"></i></span>Deadline
                                <input id="deadline" readonly value="@Model.currentTasksViewModels.FirstOrDefault().TaskDeadlineDateTime" type="text" style="margin: 1vh; padding: 10px; border-radius: 5px; border: 1px solid rgb(204, 204, 204); font-size: 16px; background-color: rgb(249, 249, 249); color: rgb(51, 51, 51); box-shadow: rgba(0, 0, 0, 0.1) 0px 2px 4px; transition: border-color 0.3s, box-shadow 0.3s;" onfocus="this.style.borderColor='#007BFF'; this.style.boxShadow='0 2px 8px rgba(0, 123, 255, 0.25)';" onblur="this.style.borderColor='#ccc'; this.style.boxShadow='0 2px 4px rgba(0, 0, 0, 0.1)';">
                            </li>
                        </ul>
                    </div>
                  
                </div>
            </div>
            <div class="col-lg-8 col-md-12 col-sm-12 col-12">

                <div class="descript_main_wrapper" id="test">
                    <h4>Task Description</h4>
                    <div class="bid-details-main">
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-12">
                                <label>Describe Your Needs</label>
                                <textarea id="taskDescription" rows="6" placeholder="">@Model.currentTasksViewModels.FirstOrDefault().TaskRequesterDescription</textarea>
                            </div>
                            <div class="col-lg-12 col-md-12 col-12">
                                <label style="margin: 0 auto;">Document Url:</label>
                                <div class="input-box">
                                    <input id="documentUrl" type="text" readonly value="@Model.currentTasksViewModels.FirstOrDefault().TaskRequesterAttatchmentsUrl" placeholder=" www.example.com">
                                    <span>
                                        <i class="fas fa-globe-americas" style="margin: 0 auto; margin-top: 2vh;"></i>
                                    </span>
                                </div>
                            </div>
                            <ul class="link_btn">
                                <li style="margin: 0 auto; display: block;">
                                    Or
                                </li>
                            </ul>
                            <div class="col-lg-12 col-md-12 col-12">
                                <!-- Remove the file input, as it's not needed for download -->
                                @if (Model.currentTasksViewModels != null && Model.currentTasksViewModels.FirstOrDefault()?.TaskRequesterAttatchmentFilePath != null)
                                {
                                    <!-- Ensure the download button is clearly for downloading -->
                                    <a id="downloadBtn" href="/uploads/Documents/@Model.currentTasksViewModels.FirstOrDefault().TaskRequesterAttatchmentFilePath"
                                       download="@Model.currentTasksViewModels.FirstOrDefault().TaskRequesterAttatchmentFilePath"
                                       class="place_btn" style="margin: 0 auto; display: block;">
                                        <span>Download File</span>
                                    </a>
                                }
                                else
                                {
                                    <p>No file available to download.</p>
                                }
                            </div>



                        </div>
                    </div>
                </div>
            </div>

            <div class="col-lg-8 col-md-12 col-sm-12 col-12">
                @if (Model.offers != null)
                {
                    @foreach (var i in Model.offers)
                    {
                        <div class="descript_main_wrapper" id="test">
                            <h4>Translator Response : @i.TranslatorName</h4>
                            <div class="bid-details-main">
                                <div class="row">
                                    <div class="col-lg-12 col-md-12 col-12">
                                        <label>Translator message:</label>
                                        <textarea id="taskDescription" rows="6" placeholder="">@i.description</textarea>
                                    </div>

                                    <div class="col-lg-12 col-md-12 col-12" style="">
                                        <div class="budget_main_wrapper" style="display: block; margin: 0 auto;">
                                            <div class="budget_img">
                                                <img src="/images/icon1.png" alt="">
                                            </div>
                                            <div class="budget_text">
                                                <h5>$@i.price</h5>
                                                <span style="display: table-column;"></span>
                                            </div>
                                        </div>
                                        <input id="deadline" readonly="" value="@i.deadline" type="text" style="margin: 1vh; padding: 10px; border-radius: 5px; border: 1px solid rgb(204, 204, 204); font-size: 16px; background-color: rgb(249, 249, 249); color: rgb(51, 51, 51); box-shadow: rgba(0, 0, 0, 0.1) 0px 2px 4px; transition: border-color 0.3s, box-shadow 0.3s; margin: 0 auto; display: block; margin-top:;" onfocus="this.style.borderColor='#007BFF'; this.style.boxShadow='0 2px 8px rgba(0, 123, 255, 0.25)';" onblur="this.style.borderColor='#ccc'; this.style.boxShadow='0 2px 4px rgba(0, 0, 0, 0.1)';">
                                        <form action="/Client/ChhooseTranslator" method="post" id="form_@i.offerId">
                                            <input type="hidden" name="offerId" value="@i.offerId" />
                                            <a class="place_btn" onclick="submitForm('form_@i.offerId')" style="margin: 0 auto; display: block; margin-top: 5vh;">
                                                <span>Approve</span>
                                            </a>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    }
                }
                else
                {
                    <div class="descript_main_wrapper" id="test">
                        <h4>Translator Rsponse</h4>
                        <div class="bid-details-main">
                            <div class="row">
                                <div class="col-lg-12 col-md-12 col-12">
                                    <label>Translator message</label>
                                    <textarea id="taskDescription" rows="6" placeholder="">@Model.currentTasksViewModels.FirstOrDefault().TaskResponserDescription</textarea>
                                </div>
                                <div class="col-lg-12 col-md-12 col-12">
                                    <label style="margin: 0 auto;">Document Url:</label>
                                    <div class="input-box">
                                        <input id="documentUrl" type="text" readonly value="@Model.currentTasksViewModels.FirstOrDefault().TaskResponserAttatchmentsUrl" placeholder=" www.example.com">
                                        <span>
                                            <i class="fas fa-globe-americas" style="margin: 0 auto; margin-top: 2vh;"></i>
                                        </span>
                                    </div>
                                </div>
                                <ul class="link_btn">
                                    <li style="margin: 0 auto; display: block;">
                                        Or
                                    </li>
                                </ul>
                                <div class="col-lg-12 col-md-12 col-12">
                                    <!-- Remove the file input, as it's not needed for download -->
                                    @if (Model.currentTasksViewModels != null && Model.currentTasksViewModels.FirstOrDefault()?.TaskResponserAttatchmentFilePath != null)
                                    {
                                        <!-- Ensure the download button is clearly for downloading -->
                                        <a id="downloadBtn" href="/uploads/Documents/@Model.currentTasksViewModels.FirstOrDefault().TaskResponserAttatchmentFilePath"
                                           download="@Model.currentTasksViewModels.FirstOrDefault().TaskResponserAttatchmentFilePath"
                                           class="place_btn" style="margin: 0 auto; display: block;">
                                            <span>Download File</span>
                                        </a>
                                    }
                                    else
                                    {
                                        <p>No file available to download.</p>
                                    }
                                </div>



                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    function submitForm(formId) {
        document.getElementById(formId).submit();  // Submit the form based on the form's ID
    }
    $(document).ready(function () {
        $('#uploadBtn').on('click', function () {
            $('#uploadedDocument').click();
        });

        $('#submitBtn').on('click', function () {
            var formData = new FormData();
            formData.append('Title', $('#title').val());
            formData.append('Deadline', $('#deadline').val());
            formData.append('TaskDescription', $('#taskDescription').val());
            formData.append('DocumentUrl', $('#documentUrl').val());
            formData.append('UploadedDocument', $('#uploadedDocument')[0].files[0]);

            $.ajax({
                url: '@Url.Action("NewServiceRequest_Video", "Client")',
                type: 'POST',
                data: formData,
                processData: false,
                contentType: false,
                success: function (response) {
                    alert('Form submitted successfully!');
                },
                error: function (xhr, status, error) {
                    alert('Form submitted successfully!');
                }
            });
        });
    });
</script>



